"use strict";(self["webpackChunkbadminton_registration"]=self["webpackChunkbadminton_registration"]||[]).push([[146],{1146:function(e,a,l){l.r(a),l.d(a,{default:function(){return J}});var s=l(6768),r=l(5130),n=l(4232);const i={class:"profile"},o={class:"container py-4"},t={class:"row justify-content-center"},d={class:"col-md-8"},c={class:"card"},u={class:"card-body"},p={key:0,class:"text-center py-4"},m={key:1},v={class:"row mb-4"},f={class:"col-md-6"},b={class:"mb-3"},k={class:"col-md-6"},L={class:"mb-3"},h={class:"mb-4"},y={class:"d-grid"},g=["disabled"];function w(e,a,l,w,x,C){return(0,s.uX)(),(0,s.CE)("div",i,[(0,s.Lk)("div",o,[(0,s.Lk)("div",t,[(0,s.Lk)("div",d,[(0,s.Lk)("div",c,[a[10]||(a[10]=(0,s.Lk)("div",{class:"card-header bg-primary text-white"},[(0,s.Lk)("h3",{class:"mb-0"},"個人資料")],-1)),(0,s.Lk)("div",u,[w.loading?((0,s.uX)(),(0,s.CE)("div",p,a[4]||(a[4]=[(0,s.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,s.Lk)("span",{class:"visually-hidden"},"載入中...")],-1),(0,s.Lk)("p",null,"載入用戶資料...",-1)]))):((0,s.uX)(),(0,s.CE)("div",m,[(0,s.Lk)("form",{onSubmit:a[3]||(a[3]=(0,r.D$)(((...e)=>w.updateProfile&&w.updateProfile(...e)),["prevent"]))},[(0,s.Lk)("div",v,[(0,s.Lk)("div",f,[(0,s.Lk)("div",b,[a[5]||(a[5]=(0,s.Lk)("label",{for:"name",class:"form-label"},"姓名",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":a[0]||(a[0]=e=>w.profile.name=e),required:""},null,512),[[r.Jo,w.profile.name]])])]),(0,s.Lk)("div",k,[(0,s.Lk)("div",L,[a[6]||(a[6]=(0,s.Lk)("label",{for:"phone",class:"form-label"},"電話",-1)),(0,s.bo)((0,s.Lk)("input",{type:"tel",class:"form-control",id:"phone","onUpdate:modelValue":a[1]||(a[1]=e=>w.profile.phone=e),required:""},null,512),[[r.Jo,w.profile.phone]])])])]),(0,s.Lk)("div",h,[a[7]||(a[7]=(0,s.Lk)("label",{for:"email",class:"form-label"},"電子郵件",-1)),(0,s.bo)((0,s.Lk)("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":a[2]||(a[2]=e=>w.profile.email=e),disabled:""},null,512),[[r.Jo,w.profile.email]]),a[8]||(a[8]=(0,s.Lk)("div",{class:"form-text"},"電子郵件無法修改",-1))]),a[9]||(a[9]=(0,s.Lk)("hr",{class:"my-4"},null,-1)),(0,s.Lk)("div",y,[(0,s.Lk)("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:w.saving},(0,n.v_)(w.saving?"儲存中...":"儲存變更"),9,g)])],32)]))])])])])])])}l(4114);var x=l(144),C=l(1387),E=l(3831),V=l(7617),_=l(1394),K={name:"ProfileView",setup(){const e=(0,C.rd)(),a=(0,x.KR)(!0),l=(0,x.KR)(!1),r=(0,x.KR)(null),n=(0,x.KR)({name:"",email:"",phone:""});(0,s.sV)((()=>{(0,E.hg)(_.j,(async a=>{a?(r.value=a,await i(a.uid)):e.push("/login")}))}));const i=async e=>{try{const a=await(0,V.x7)((0,V.H9)(_.db,"users",e));if(a.exists()){const e=a.data();n.value={name:e.name||"",email:e.email||"",phone:e.phone||""}}}catch(l){console.error("Error fetching user data:",l),alert("無法載入用戶資料，請稍後再試")}finally{a.value=!1}},o=async()=>{if(n.value.name&&n.value.phone){l.value=!0;try{const a=(0,V.H9)(_.db,"users",r.value.uid);await(0,V.mZ)(a,{name:n.value.name,phone:n.value.phone,updatedAt:(0,V.O5)()}),alert("個人資料已更新"),e.push("/dashboard")}catch(a){console.error("Error updating profile:",a),alert("更新個人資料失敗，請稍後再試")}finally{l.value=!1}}else alert("請填寫所有必填欄位")};return{loading:a,saving:l,profile:n,updateProfile:o}}},P=l(1241);const R=(0,P.A)(K,[["render",w],["__scopeId","data-v-0a695243"]]);var J=R}}]);
//# sourceMappingURL=146.6faee840.js.map