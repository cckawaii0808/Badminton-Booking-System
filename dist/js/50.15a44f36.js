"use strict";(self["webpackChunkbadminton_registration"]=self["webpackChunkbadminton_registration"]||[]).push([[50],{7050:function(s,t,a){a.r(t),a.d(t,{default:function(){return rs}});var e=a(6768),i=a(4232);const l={class:"admin-dashboard"},n={class:"container py-4"},c={class:"row"},d={class:"col-md-4 mb-4"},r={class:"card h-100"},o={class:"card-body text-center p-4"},k={class:"col-md-4 mb-4"},u={class:"card h-100"},v={class:"card-body text-center p-4"},b={class:"col-md-4 mb-4"},m={class:"card h-100"},L={class:"card-body text-center p-4"},p={class:"row mt-2"},g={class:"col-12"},h={class:"card"},y={class:"card-body"},w={class:"row"},f={class:"col-md-3 mb-3 mb-md-0"},_={class:"stat-card"},x={class:"stat-value"},C={class:"col-md-3 mb-3 mb-md-0"},E={class:"stat-card"},G={class:"stat-value"},S={class:"col-md-3 mb-3 mb-md-0"},W={class:"stat-card"},X={class:"stat-value"},R={class:"col-md-3"},D={class:"stat-card"},F={class:"stat-value"},P={class:"row mt-4"},K={class:"col-md-6 mb-4"},J={class:"card h-100"},z={class:"card-body p-0"},I={key:0,class:"text-center py-4"},j={key:1,class:"text-center py-4"},A={key:2,class:"list-group list-group-flush"},M={class:"d-flex justify-content-between align-items-center"},T={class:"text-muted small"},U={class:"d-flex justify-content-between align-items-center mt-1"},B={class:"card-footer bg-white border-top"},H={class:"col-md-6 mb-4"},V={class:"card h-100"},$={class:"card-body p-0"},q={key:0,class:"text-center py-4"},N={key:1,class:"text-center py-4"},O={key:2,class:"list-group list-group-flush"},Q={class:"d-flex justify-content-between align-items-center"},Y={class:"mt-1"},Z={class:"card-footer bg-white border-top"};function ss(s,t,a,ss,ts,as){const es=(0,e.g2)("router-link");return(0,e.uX)(),(0,e.CE)("div",l,[(0,e.Lk)("div",n,[t[29]||(t[29]=(0,e.Lk)("h1",{class:"mb-4"},"管理員儀表板",-1)),(0,e.Lk)("div",c,[(0,e.Lk)("div",d,[(0,e.Lk)("div",r,[(0,e.Lk)("div",o,[t[1]||(t[1]=(0,e.Lk)("div",{class:"icon-wrapper bg-primary text-white mb-3"},[(0,e.Lk)("i",{class:"bi bi-calendar-event"})],-1)),t[2]||(t[2]=(0,e.Lk)("h3",null,"場次管理",-1)),t[3]||(t[3]=(0,e.Lk)("p",null,"管理羽球場地的開放場次、修改場次資訊、控制報名狀態",-1)),(0,e.bF)(es,{to:"/admin/sessions",class:"btn btn-primary w-100"},{default:(0,e.k6)((()=>t[0]||(t[0]=[(0,e.eW)(" 進入管理 ")]))),_:1})])])]),(0,e.Lk)("div",k,[(0,e.Lk)("div",u,[(0,e.Lk)("div",v,[t[5]||(t[5]=(0,e.Lk)("div",{class:"icon-wrapper bg-success text-white mb-3"},[(0,e.Lk)("i",{class:"bi bi-people"})],-1)),t[6]||(t[6]=(0,e.Lk)("h3",null,"報名管理",-1)),t[7]||(t[7]=(0,e.Lk)("p",null,"管理用戶報名記錄、查看詳情、處理付款狀態、移除報名",-1)),(0,e.bF)(es,{to:"/admin/registrations",class:"btn btn-success w-100"},{default:(0,e.k6)((()=>t[4]||(t[4]=[(0,e.eW)(" 進入管理 ")]))),_:1})])])]),(0,e.Lk)("div",b,[(0,e.Lk)("div",m,[(0,e.Lk)("div",L,[t[9]||(t[9]=(0,e.Lk)("div",{class:"icon-wrapper bg-danger text-white mb-3"},[(0,e.Lk)("i",{class:"bi bi-shield-exclamation"})],-1)),t[10]||(t[10]=(0,e.Lk)("h3",null,"黑名單管理",-1)),t[11]||(t[11]=(0,e.Lk)("p",null,"管理系統黑名單，禁止不良用戶報名參加場次",-1)),(0,e.bF)(es,{to:"/admin/blacklist",class:"btn btn-danger w-100"},{default:(0,e.k6)((()=>t[8]||(t[8]=[(0,e.eW)(" 進入管理 ")]))),_:1})])])])]),(0,e.Lk)("div",p,[(0,e.Lk)("div",g,[(0,e.Lk)("div",h,[t[16]||(t[16]=(0,e.Lk)("div",{class:"card-header bg-dark text-white"},[(0,e.Lk)("h5",{class:"mb-0"},"系統摘要")],-1)),(0,e.Lk)("div",y,[(0,e.Lk)("div",w,[(0,e.Lk)("div",f,[(0,e.Lk)("div",_,[t[12]||(t[12]=(0,e.Lk)("div",{class:"stat-title"},"總場次數",-1)),(0,e.Lk)("div",x,(0,i.v_)(ss.loading?"載入中...":ss.stats.totalSessions),1)])]),(0,e.Lk)("div",C,[(0,e.Lk)("div",E,[t[13]||(t[13]=(0,e.Lk)("div",{class:"stat-title"},"開放場次",-1)),(0,e.Lk)("div",G,(0,i.v_)(ss.loading?"載入中...":ss.stats.openSessions),1)])]),(0,e.Lk)("div",S,[(0,e.Lk)("div",W,[t[14]||(t[14]=(0,e.Lk)("div",{class:"stat-title"},"總報名數",-1)),(0,e.Lk)("div",X,(0,i.v_)(ss.loading?"載入中...":ss.stats.totalRegistrations),1)])]),(0,e.Lk)("div",R,[(0,e.Lk)("div",D,[t[15]||(t[15]=(0,e.Lk)("div",{class:"stat-title"},"總用戶數",-1)),(0,e.Lk)("div",F,(0,i.v_)(ss.loading?"載入中...":ss.stats.totalUsers),1)])])])])])])]),(0,e.Lk)("div",P,[(0,e.Lk)("div",K,[(0,e.Lk)("div",J,[t[21]||(t[21]=(0,e.Lk)("div",{class:"card-header bg-primary text-white"},[(0,e.Lk)("h5",{class:"mb-0"},"近期報名")],-1)),(0,e.Lk)("div",z,[ss.loading?((0,e.uX)(),(0,e.CE)("div",I,t[17]||(t[17]=[(0,e.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,e.Lk)("span",{class:"visually-hidden"},"載入中...")],-1)]))):0===ss.recentRegistrations.length?((0,e.uX)(),(0,e.CE)("div",j,t[18]||(t[18]=[(0,e.Lk)("p",{class:"mb-0"},"暫無報名記錄",-1)]))):((0,e.uX)(),(0,e.CE)("div",A,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(ss.recentRegistrations,(s=>((0,e.uX)(),(0,e.CE)("div",{key:s.id,class:"list-group-item"},[(0,e.Lk)("div",M,[(0,e.Lk)("div",null,[(0,e.Lk)("strong",null,(0,i.v_)(s.participants[0].name),1),t[19]||(t[19]=(0,e.eW)(" 報名了 ")),(0,e.bF)(es,{to:`/registration/${s.sessionId}`},{default:(0,e.k6)((()=>[(0,e.eW)((0,i.v_)(s.sessionTitle),1)])),_:2},1032,["to"])]),(0,e.Lk)("span",T,(0,i.v_)(ss.formatDate(s.timestamp)),1)]),(0,e.Lk)("div",U,[(0,e.Lk)("span",null,"參加人數: "+(0,i.v_)(s.participants.length)+" 人",1),(0,e.Lk)("span",{class:(0,i.C4)("已付款"===s.paymentStatus?"badge bg-success":"badge bg-warning")},(0,i.v_)(s.paymentStatus),3)])])))),128))]))]),(0,e.Lk)("div",B,[(0,e.bF)(es,{to:"/admin/registrations",class:"btn btn-sm btn-outline-primary"},{default:(0,e.k6)((()=>t[20]||(t[20]=[(0,e.eW)("查看所有報名")]))),_:1})])])]),(0,e.Lk)("div",H,[(0,e.Lk)("div",V,[t[28]||(t[28]=(0,e.Lk)("div",{class:"card-header bg-success text-white"},[(0,e.Lk)("h5",{class:"mb-0"},"即將開始的場次")],-1)),(0,e.Lk)("div",$,[ss.loading?((0,e.uX)(),(0,e.CE)("div",q,t[22]||(t[22]=[(0,e.Lk)("div",{class:"spinner-border text-success",role:"status"},[(0,e.Lk)("span",{class:"visually-hidden"},"載入中...")],-1)]))):0===ss.upcomingSessions.length?((0,e.uX)(),(0,e.CE)("div",N,t[23]||(t[23]=[(0,e.Lk)("p",{class:"mb-0"},"暫無即將開始的場次",-1)]))):((0,e.uX)(),(0,e.CE)("div",O,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(ss.upcomingSessions,(s=>((0,e.uX)(),(0,e.CE)("div",{key:s.id,class:"list-group-item"},[(0,e.Lk)("div",Q,[(0,e.Lk)("div",null,[(0,e.Lk)("strong",null,(0,i.v_)(s.title),1)]),(0,e.Lk)("span",{class:(0,i.C4)("開放"===s.status?"badge bg-success":"badge bg-danger")},(0,i.v_)(s.status),3)]),(0,e.Lk)("div",Y,[(0,e.Lk)("div",null,[t[24]||(t[24]=(0,e.Lk)("i",{class:"bi bi-calendar me-1"},null,-1)),(0,e.eW)(" "+(0,i.v_)(ss.formatDate(s.date)),1)]),(0,e.Lk)("div",null,[t[25]||(t[25]=(0,e.Lk)("i",{class:"bi bi-geo-alt me-1"},null,-1)),(0,e.eW)(" "+(0,i.v_)(s.location),1)]),(0,e.Lk)("div",null,[t[26]||(t[26]=(0,e.Lk)("i",{class:"bi bi-people me-1"},null,-1)),(0,e.eW)(" 報名人數: "+(0,i.v_)(s.currentParticipants)+"/"+(0,i.v_)(s.maxParticipants),1)])])])))),128))]))]),(0,e.Lk)("div",Z,[(0,e.bF)(es,{to:"/admin/sessions",class:"btn btn-sm btn-outline-success"},{default:(0,e.k6)((()=>t[27]||(t[27]=[(0,e.eW)("管理所有場次")]))),_:1})])])])])])])}a(4114),a(8111),a(1701);var ts=a(144),as=a(7617),es=a(3831),is=a(1394),ls=a(1387),ns={name:"AdminDashboard",setup(){const s=(0,ls.rd)(),t=(0,ts.KR)(!0),a=(0,ts.KR)(null),i=(0,ts.Kh)({totalSessions:0,openSessions:0,totalRegistrations:0,totalUsers:0}),l=(0,ts.KR)([]),n=(0,ts.KR)([]);(0,e.sV)((()=>{(0,es.hg)(is.j,(async t=>{if(t){a.value=t;const e=await(0,as.x7)((0,as.H9)(is.db,"users",t.uid));e.exists()&&"admin"===e.data().role?(c(),d(),r()):(alert("您沒有管理員權限"),s.push("/dashboard"))}else s.push("/login")}))}));const c=async()=>{try{const s=(0,as.P)((0,as.rJ)(is.db,"sessions")),t=await(0,as.GG)(s);i.totalSessions=t.size;const a=(0,as.P)((0,as.rJ)(is.db,"sessions"),(0,as._M)("status","==","開放")),e=await(0,as.GG)(a);i.openSessions=e.size;const l=(0,as.P)((0,as.rJ)(is.db,"registrations")),n=await(0,as.GG)(l);i.totalRegistrations=n.size;const c=(0,as.P)((0,as.rJ)(is.db,"users")),d=await(0,as.GG)(c);i.totalUsers=d.size}catch(s){console.error("Error fetching stats:",s)}},d=async()=>{try{const s=(0,as.P)((0,as.rJ)(is.db,"registrations"),(0,as.My)("timestamp","desc"),(0,as.AB)(5)),t=await(0,as.GG)(s),a=t.docs.map((s=>({id:s.id,...s.data(),timestamp:s.data().timestamp?.toDate()||new Date})));for(const e of a){const s=await(0,as.x7)((0,as.H9)(is.db,"sessions",e.sessionId));s.exists()?e.sessionTitle=s.data().title:e.sessionTitle="未知場次"}l.value=a}catch(s){console.error("Error fetching recent registrations:",s)}},r=async()=>{try{const s=new Date,a=(0,as.P)((0,as.rJ)(is.db,"sessions"),(0,as._M)("date",">=",s),(0,as.My)("date"),(0,as.AB)(5)),e=await(0,as.GG)(a);n.value=e.docs.map((s=>({id:s.id,...s.data(),date:s.data().date.toDate()}))),t.value=!1}catch(s){console.error("Error fetching upcoming sessions:",s)}finally{t.value=!1}},o=s=>s?new Date(s).toLocaleString("zh-TW",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"未知時間";return{loading:t,stats:i,recentRegistrations:l,upcomingSessions:n,formatDate:o}}},cs=a(1241);const ds=(0,cs.A)(ns,[["render",ss],["__scopeId","data-v-7e508cf4"]]);var rs=ds}}]);
//# sourceMappingURL=50.15a44f36.js.map