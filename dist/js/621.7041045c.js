"use strict";(self["webpackChunkbadminton_registration"]=self["webpackChunkbadminton_registration"]||[]).push([[621],{8621:function(e,t,s){s.r(t),s.d(t,{default:function(){return K}});var a=s(6768),i=s(5130),n=s(4232);const r={class:"sessions"},l={class:"container py-4"},c={class:"d-flex justify-content-between align-items-center mb-4"},o={class:"d-flex"},d={class:"form-check form-switch me-3"},u={key:0,class:"text-center py-5"},k={key:1,class:"text-center py-5"},v={class:"alert alert-info"},b={key:2,class:"row"},p={class:"d-flex justify-content-between align-items-center"},m={class:"mb-0"},g={class:"card-body"},L={class:"mb-3"},h={class:"mb-2"},w={class:"mb-2"},f={class:"mb-2"},y={class:"mb-2"},E={key:0,class:"mb-3"},P={class:"text-muted small"},x={class:"card-footer bg-white border-top-0"};function D(e,t,s,D,_,C){const W=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.Lk)("div",l,[(0,a.Lk)("div",c,[t[4]||(t[4]=(0,a.Lk)("h1",null,"開放場次列表",-1)),(0,a.Lk)("div",o,[(0,a.Lk)("div",d,[(0,a.bo)((0,a.Lk)("input",{class:"form-check-input",type:"checkbox",id:"showPastEvents","onUpdate:modelValue":t[0]||(t[0]=e=>D.showPastEvents=e)},null,512),[[i.lH,D.showPastEvents]]),t[2]||(t[2]=(0,a.Lk)("label",{class:"form-check-label",for:"showPastEvents"},"顯示過期場次",-1))]),(0,a.bo)((0,a.Lk)("select",{class:"form-select","onUpdate:modelValue":t[1]||(t[1]=e=>D.sortOrder=e)},t[3]||(t[3]=[(0,a.Lk)("option",{value:"dateAsc"},"日期 (近 -> 遠)",-1),(0,a.Lk)("option",{value:"dateDesc"},"日期 (遠 -> 近)",-1),(0,a.Lk)("option",{value:"priceAsc"},"費用 (低 -> 高)",-1),(0,a.Lk)("option",{value:"priceDesc"},"費用 (高 -> 低)",-1)]),512),[[i.u1,D.sortOrder]])])]),D.loading?((0,a.uX)(),(0,a.CE)("div",u,t[5]||(t[5]=[(0,a.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,a.Lk)("span",{class:"visually-hidden"},"載入中...")],-1),(0,a.Lk)("p",{class:"mt-2"},"載入場次資料...",-1)]))):0===D.filteredSessions.length?((0,a.uX)(),(0,a.CE)("div",k,[(0,a.Lk)("div",v,[t[6]||(t[6]=(0,a.Lk)("i",{class:"bi bi-info-circle-fill me-2"},null,-1)),(0,a.eW)(" "+(0,n.v_)(D.showPastEvents?"目前沒有任何場次":"目前沒有開放的場次"),1)])])):((0,a.uX)(),(0,a.CE)("div",b,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(D.filteredSessions,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id,class:"col-md-4 mb-4"},[(0,a.Lk)("div",{class:(0,n.C4)(["card h-100",{"border-warning":D.isPastEvent(e.date)}])},[(0,a.Lk)("div",{class:(0,n.C4)(["card-header",{"bg-success text-white":"開放"===e.status&&!D.isPastEvent(e.date),"bg-danger text-white":"關閉"===e.status,"bg-warning text-dark":D.isPastEvent(e.date)}])},[(0,a.Lk)("div",p,[(0,a.Lk)("h5",m,(0,n.v_)(e.title),1),(0,a.Lk)("span",{class:(0,n.C4)(["badge",{"bg-light text-dark":"開放"===e.status&&!D.isPastEvent(e.date),"bg-danger":"關閉"===e.status,"bg-secondary":D.isPastEvent(e.date)}])},(0,n.v_)(D.isPastEvent(e.date)?"已過期":e.status),3)])],2),(0,a.Lk)("div",g,[(0,a.Lk)("div",L,[(0,a.Lk)("div",h,[t[7]||(t[7]=(0,a.Lk)("i",{class:"bi bi-calendar me-2"},null,-1)),t[8]||(t[8]=(0,a.eW)()),t[9]||(t[9]=(0,a.Lk)("strong",null,"時間：",-1)),(0,a.eW)(" "+(0,n.v_)(D.formatDate(e.date)),1)]),(0,a.Lk)("div",w,[t[10]||(t[10]=(0,a.Lk)("i",{class:"bi bi-geo-alt me-2"},null,-1)),t[11]||(t[11]=(0,a.eW)()),t[12]||(t[12]=(0,a.Lk)("strong",null,"地點：",-1)),(0,a.eW)(" "+(0,n.v_)(e.location),1)]),(0,a.Lk)("div",f,[t[13]||(t[13]=(0,a.Lk)("i",{class:"bi bi-people me-2"},null,-1)),t[14]||(t[14]=(0,a.eW)()),t[15]||(t[15]=(0,a.Lk)("strong",null,"人數：",-1)),(0,a.Lk)("span",{class:(0,n.C4)({"text-danger":e.currentParticipants>=e.maxParticipants})},(0,n.v_)(e.currentParticipants)+"/"+(0,n.v_)(e.maxParticipants),3)]),(0,a.Lk)("div",y,[t[16]||(t[16]=(0,a.Lk)("i",{class:"bi bi-currency-dollar me-2"},null,-1)),t[17]||(t[17]=(0,a.eW)()),t[18]||(t[18]=(0,a.Lk)("strong",null,"費用：",-1)),(0,a.eW)(" "+(0,n.v_)(e.price)+" 元 ",1)])]),e.details?((0,a.uX)(),(0,a.CE)("div",E,[(0,a.Lk)("div",P,(0,n.v_)(D.truncateText(e.details,100)),1)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",x,[(0,a.bF)(W,{to:`/registration/${e.id}`,class:(0,n.C4)(["btn btn-primary w-100",{disabled:D.shouldDisableRegistration(e)}])},{default:(0,a.k6)((()=>[(0,a.eW)((0,n.v_)(D.getRegistrationButtonText(e)),1)])),_:2},1032,["to","class"])])],2)])))),128))]))])])}s(8111),s(2489),s(1701);var _=s(144),C=s(7617),W=s(1394),R={name:"SessionsView",setup(){const e=(0,_.KR)([]),t=(0,_.KR)(!0),s=(0,_.KR)(!1),i=(0,_.KR)("dateAsc");(0,a.sV)((async()=>{await n()}));const n=async()=>{try{t.value=!0;let s=(0,C.P)((0,C.rJ)(W.db,"sessions"),(0,C.My)("date","asc"));const a=await(0,C.GG)(s);e.value=a.docs.map((e=>({id:e.id,...e.data(),date:e.data().date.toDate()})))}catch(s){console.error("Error fetching sessions:",s),alert("載入場次資料失敗，請稍後再試")}finally{t.value=!1}},r=(0,a.EW)((()=>{let t=[...e.value];if(!s.value){const e=new Date;t=t.filter((t=>new Date(t.date)>=e))}switch(i.value){case"dateAsc":t.sort(((e,t)=>new Date(e.date)-new Date(t.date)));break;case"dateDesc":t.sort(((e,t)=>new Date(t.date)-new Date(e.date)));break;case"priceAsc":t.sort(((e,t)=>e.price-t.price));break;case"priceDesc":t.sort(((e,t)=>t.price-e.price));break}return t})),l=e=>new Date(e)<new Date,c=(e,t)=>e?e.length<=t?e:e.slice(0,t)+"...":"",o=e=>"關閉"===e.status||l(e.date)||e.currentParticipants>=e.maxParticipants,d=e=>"關閉"===e.status?"已關閉報名":l(e.date)?"已過期":e.currentParticipants>=e.maxParticipants?"已額滿":"立即報名",u=e=>new Date(e).toLocaleString("zh-TW",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",weekday:"long"});return{sessions:e,loading:t,showPastEvents:s,sortOrder:i,filteredSessions:r,isPastEvent:l,truncateText:c,shouldDisableRegistration:o,getRegistrationButtonText:d,formatDate:u}}},X=s(1241);const A=(0,X.A)(R,[["render",D],["__scopeId","data-v-723cb91a"]]);var K=A}}]);
//# sourceMappingURL=621.7041045c.js.map