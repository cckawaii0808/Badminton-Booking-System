{"version":3,"file":"js/621.7041045c.js","mappings":"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","sources":["webpack://badminton-registration/./src/views/SessionsView.vue","webpack://badminton-registration/./src/views/SessionsView.vue?bd12"],"sourcesContent":["<template>\r\n  <div class=\"sessions\">\r\n    <div class=\"container py-4\">\r\n      <div class=\"d-flex justify-content-between align-items-center mb-4\">\r\n        <h1>開放場次列表</h1>\r\n        <div class=\"d-flex\">\r\n          <div class=\"form-check form-switch me-3\">\r\n            <input class=\"form-check-input\" type=\"checkbox\" id=\"showPastEvents\" v-model=\"showPastEvents\">\r\n            <label class=\"form-check-label\" for=\"showPastEvents\">顯示過期場次</label>\r\n          </div>\r\n          <select class=\"form-select\" v-model=\"sortOrder\">\r\n            <option value=\"dateAsc\">日期 (近 -> 遠)</option>\r\n            <option value=\"dateDesc\">日期 (遠 -> 近)</option>\r\n            <option value=\"priceAsc\">費用 (低 -> 高)</option>\r\n            <option value=\"priceDesc\">費用 (高 -> 低)</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      <div v-if=\"loading\" class=\"text-center py-5\">\r\n        <div class=\"spinner-border text-primary\" role=\"status\">\r\n          <span class=\"visually-hidden\">載入中...</span>\r\n        </div>\r\n        <p class=\"mt-2\">載入場次資料...</p>\r\n      </div>\r\n      \r\n      <div v-else-if=\"filteredSessions.length === 0\" class=\"text-center py-5\">\r\n        <div class=\"alert alert-info\">\r\n          <i class=\"bi bi-info-circle-fill me-2\"></i>\r\n          {{ showPastEvents ? '目前沒有任何場次' : '目前沒有開放的場次' }}\r\n        </div>\r\n      </div>\r\n      \r\n      <div v-else class=\"row\">\r\n        <div v-for=\"session in filteredSessions\" :key=\"session.id\" class=\"col-md-4 mb-4\">\r\n          <div class=\"card h-100\" :class=\"{ 'border-warning': isPastEvent(session.date) }\">\r\n            <div class=\"card-header\" :class=\"{ \r\n              'bg-success text-white': session.status === '開放' && !isPastEvent(session.date), \r\n              'bg-danger text-white': session.status === '關閉',\r\n              'bg-warning text-dark': isPastEvent(session.date)\r\n            }\">\r\n              <div class=\"d-flex justify-content-between align-items-center\">\r\n                <h5 class=\"mb-0\">{{ session.title }}</h5>\r\n                <span class=\"badge\" :class=\"{\r\n                  'bg-light text-dark': session.status === '開放' && !isPastEvent(session.date),\r\n                  'bg-danger': session.status === '關閉',\r\n                  'bg-secondary': isPastEvent(session.date)\r\n                }\">\r\n                  {{ isPastEvent(session.date) ? '已過期' : session.status }}\r\n                </span>\r\n              </div>\r\n            </div>\r\n            <div class=\"card-body\">\r\n              <div class=\"mb-3\">\r\n                <div class=\"mb-2\">\r\n                  <i class=\"bi bi-calendar me-2\"></i> <strong>時間：</strong> {{ formatDate(session.date) }}\r\n                </div>\r\n                <div class=\"mb-2\">\r\n                  <i class=\"bi bi-geo-alt me-2\"></i> <strong>地點：</strong> {{ session.location }}\r\n                </div>\r\n                <div class=\"mb-2\">\r\n                  <i class=\"bi bi-people me-2\"></i> <strong>人數：</strong> \r\n                  <span :class=\"{'text-danger': session.currentParticipants >= session.maxParticipants}\">\r\n                    {{ session.currentParticipants }}/{{ session.maxParticipants }}\r\n                  </span>\r\n                </div>\r\n                <div class=\"mb-2\">\r\n                  <i class=\"bi bi-currency-dollar me-2\"></i> <strong>費用：</strong> {{ session.price }} 元\r\n                </div>\r\n              </div>\r\n              \r\n              <div v-if=\"session.details\" class=\"mb-3\">\r\n                <div class=\"text-muted small\">{{ truncateText(session.details, 100) }}</div>\r\n              </div>\r\n            </div>\r\n            <div class=\"card-footer bg-white border-top-0\">\r\n              <router-link \r\n                :to=\"`/registration/${session.id}`\" \r\n                class=\"btn btn-primary w-100\"\r\n                :class=\"{ disabled: shouldDisableRegistration(session) }\"\r\n              >\r\n                {{ getRegistrationButtonText(session) }}\r\n              </router-link>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n/* eslint-disable no-unused-vars */\r\nimport { ref, computed, onMounted } from 'vue';\r\nimport { collection, query, orderBy, getDocs, where } from 'firebase/firestore';\r\nimport { db } from '@/firebase';\r\n\r\nexport default {\r\n  name: 'SessionsView',\r\n  setup() {\r\n    const sessions = ref([]);\r\n    const loading = ref(true);\r\n    const showPastEvents = ref(false);\r\n    const sortOrder = ref('dateAsc');\r\n    \r\n    onMounted(async () => {\r\n      await fetchSessions();\r\n    });\r\n    \r\n    const fetchSessions = async () => {\r\n      try {\r\n        loading.value = true;\r\n        \r\n        // 基本查詢 - 獲取所有場次\r\n        let sessionsQuery = query(\r\n          collection(db, 'sessions'),\r\n          orderBy('date', 'asc')\r\n        );\r\n        \r\n        const querySnapshot = await getDocs(sessionsQuery);\r\n        sessions.value = querySnapshot.docs.map(doc => ({\r\n          id: doc.id,\r\n          ...doc.data(),\r\n          date: doc.data().date.toDate()\r\n        }));\r\n      } catch (e) {\r\n        console.error('Error fetching sessions:', e);\r\n        alert('載入場次資料失敗，請稍後再試');\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n    \r\n    // 過濾和排序後的場次列表\r\n    const filteredSessions = computed(() => {\r\n      let filtered = [...sessions.value];\r\n      \r\n      // 如果不顯示過期場次，則過濾掉\r\n      if (!showPastEvents.value) {\r\n        const now = new Date();\r\n        filtered = filtered.filter(session => new Date(session.date) >= now);\r\n      }\r\n      \r\n      // 根據選擇的排序方式進行排序\r\n      switch (sortOrder.value) {\r\n        case 'dateAsc':\r\n          filtered.sort((a, b) => new Date(a.date) - new Date(b.date));\r\n          break;\r\n        case 'dateDesc':\r\n          filtered.sort((a, b) => new Date(b.date) - new Date(a.date));\r\n          break;\r\n        case 'priceAsc':\r\n          filtered.sort((a, b) => a.price - b.price);\r\n          break;\r\n        case 'priceDesc':\r\n          filtered.sort((a, b) => b.price - a.price);\r\n          break;\r\n      }\r\n      \r\n      return filtered;\r\n    });\r\n    \r\n    // 判斷場次是否已過期\r\n    const isPastEvent = (date) => {\r\n      return new Date(date) < new Date();\r\n    };\r\n    \r\n    // 顯示有限的文字內容\r\n    const truncateText = (text, maxLength) => {\r\n      if (!text) return '';\r\n      if (text.length <= maxLength) return text;\r\n      return text.slice(0, maxLength) + '...';\r\n    };\r\n    \r\n    // 判斷是否應該禁用報名按鈕\r\n    const shouldDisableRegistration = (session) => {\r\n      return session.status === '關閉' || \r\n             isPastEvent(session.date) || \r\n             session.currentParticipants >= session.maxParticipants;\r\n    };\r\n    \r\n    // 獲取報名按鈕文字\r\n    const getRegistrationButtonText = (session) => {\r\n      if (session.status === '關閉') return '已關閉報名';\r\n      if (isPastEvent(session.date)) return '已過期';\r\n      if (session.currentParticipants >= session.maxParticipants) return '已額滿';\r\n      return '立即報名';\r\n    };\r\n    \r\n    // 格式化日期\r\n    const formatDate = (date) => {\r\n      return new Date(date).toLocaleString('zh-TW', {\r\n        year: 'numeric',\r\n        month: 'long',\r\n        day: 'numeric',\r\n        hour: '2-digit',\r\n        minute: '2-digit',\r\n        weekday: 'long'\r\n      });\r\n    };\r\n    \r\n    return {\r\n      sessions,\r\n      loading,\r\n      showPastEvents,\r\n      sortOrder,\r\n      filteredSessions,\r\n      isPastEvent,\r\n      truncateText,\r\n      shouldDisableRegistration,\r\n      getRegistrationButtonText,\r\n      formatDate\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.sessions {\r\n  padding-bottom: 2rem;\r\n}\r\n\r\n.card {\r\n  transition: transform 0.2s;\r\n  box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);\r\n}\r\n\r\n.card:hover {\r\n  transform: translateY(-5px);\r\n  box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.card-header {\r\n  padding: 0.75rem 1.25rem;\r\n}\r\n\r\n.card-body {\r\n  padding: 1.25rem;\r\n}\r\n\r\n.card-footer {\r\n  padding: 1rem 1.25rem;\r\n}\r\n\r\n.badge {\r\n  font-size: 0.75rem;\r\n  padding: 0.35em 0.65em;\r\n}\r\n</style>","import { render } from \"./SessionsView.vue?vue&type=template&id=723cb91a&scoped=true\"\nimport script from \"./SessionsView.vue?vue&type=script&lang=js\"\nexport * from \"./SessionsView.vue?vue&type=script&lang=js\"\n\nimport \"./SessionsView.vue?vue&type=style&index=0&id=723cb91a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-723cb91a\"]])\n\nexport default __exports__"],"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","type","id","_cache","$event","$setup","showPastEvents","for","sortOrder","value","loading","_hoisted_6","role","filteredSessions","length","_hoisted_7","_hoisted_8","_createTextVNode","_toDisplayString","_hoisted_9","_Fragment","_renderList","session","_normalizeClass","isPastEvent","date","status","_hoisted_10","_hoisted_11","title","_hoisted_12","_hoisted_13","_hoisted_14","formatDate","_hoisted_15","location","_hoisted_16","currentParticipants","maxParticipants","_hoisted_17","price","details","_hoisted_18","_hoisted_19","truncateText","_createCommentVNode","_hoisted_20","_createVNode","_component_router_link","to","disabled","shouldDisableRegistration","default","_withCtx","getRegistrationButtonText","_","name","setup","sessions","ref","onMounted","async","fetchSessions","sessionsQuery","query","collection","db","orderBy","querySnapshot","getDocs","docs","map","doc","data","toDate","e","console","error","alert","computed","filtered","now","Date","filter","sort","a","b","text","maxLength","slice","toLocaleString","year","month","day","hour","minute","weekday","__exports__","render"],"sourceRoot":""}