{"version":3,"file":"js/146.a869c831.js","mappings":"mOACOA,MAAM,W,GACJA,MAAM,kB,GACJA,MAAM,8B,GACJA,MAAM,Y,GACJA,MAAM,Q,GAIJA,MAAM,a,GATvBC,IAAA,EAUkCD,MAAM,oB,GAVxCC,IAAA,G,GAmBuBD,MAAM,Y,GACJA,MAAM,Y,GACJA,MAAM,Q,GAWRA,MAAM,Y,GACJA,MAAM,Q,GAaVA,MAAM,Q,GAcNA,MAAM,U,EA5D7B,a,0CACEE,EAAAA,EAAAA,IA2EM,MA3ENC,EA2EM,EA1EJC,EAAAA,EAAAA,IAyEM,MAzENC,EAyEM,EAxEJD,EAAAA,EAAAA,IAuEM,MAvENE,EAuEM,EAtEJF,EAAAA,EAAAA,IAqEM,MArENG,EAqEM,EApEJH,EAAAA,EAAAA,IAmEM,MAnENI,EAmEM,gBAlEJJ,EAAAA,EAAAA,IAEM,OAFDJ,MAAM,qCAAmC,EAC5CI,EAAAA,EAAAA,IAA0B,MAAtBJ,MAAM,QAAO,UAAI,KAEvBI,EAAAA,EAAAA,IA8DM,MA9DNK,EA8DM,CA7DOC,EAAAC,UAAO,WAAlBT,EAAAA,EAAAA,IAKM,MALNU,EAKMC,EAAA,KAAAA,EAAA,KAJJT,EAAAA,EAAAA,IAEM,OAFDJ,MAAM,8BAA8Bc,KAAK,U,EAC5CV,EAAAA,EAAAA,IAA2C,QAArCJ,MAAM,mBAAkB,YAAM,IAEtCI,EAAAA,EAAAA,IAAgB,SAAb,aAAS,oBAGdF,EAAAA,EAAAA,IAqDM,MAtEpBa,EAAA,EAkBgBX,EAAAA,EAAAA,IAmDO,QAnDAY,SAAMH,EAAA,KAAAA,EAAA,IAlB7BI,EAAAA,EAAAA,KAAA,IAAAC,IAkBuCR,EAAAS,eAAAT,EAAAS,iBAAAD,IAAa,e,EAClCd,EAAAA,EAAAA,IAyBM,MAzBNgB,EAyBM,EAxBJhB,EAAAA,EAAAA,IAWM,MAXNiB,EAWM,EAVJjB,EAAAA,EAAAA,IASM,MATNkB,EASM,cARJlB,EAAAA,EAAAA,IAA+C,SAAxCmB,IAAI,OAAOvB,MAAM,cAAa,MAAE,cACvCI,EAAAA,EAAAA,IAMC,SALCoB,KAAK,OACLxB,MAAM,eACNyB,GAAG,OA1B7B,sBAAAZ,EAAA,KAAAA,EAAA,GAAAa,GA2BmChB,EAAAiB,QAAQC,KAAIF,GACrBG,SAAA,I,iBADSnB,EAAAiB,QAAQC,aAKvBxB,EAAAA,EAAAA,IAWM,MAXN0B,EAWM,EAVJ1B,EAAAA,EAAAA,IASM,MATN2B,EASM,cARJ3B,EAAAA,EAAAA,IAAgD,SAAzCmB,IAAI,QAAQvB,MAAM,cAAa,MAAE,cACxCI,EAAAA,EAAAA,IAMC,SALCoB,KAAK,MACLxB,MAAM,eACNyB,GAAG,QAtC7B,sBAAAZ,EAAA,KAAAA,EAAA,GAAAa,GAuCmChB,EAAAiB,QAAQK,MAAKN,GACtBG,SAAA,I,iBADSnB,EAAAiB,QAAQK,gBAOzB5B,EAAAA,EAAAA,IAUM,MAVN6B,EAUM,cATJ7B,EAAAA,EAAAA,IAAkD,SAA3CmB,IAAI,QAAQvB,MAAM,cAAa,QAAI,cAC1CI,EAAAA,EAAAA,IAMC,SALCoB,KAAK,QACLxB,MAAM,eACNyB,GAAG,QAnDzB,sBAAAZ,EAAA,KAAAA,EAAA,GAAAa,GAoD+BhB,EAAAiB,QAAQO,MAAKR,GACtBS,SAAA,I,iBADSzB,EAAAiB,QAAQO,SAAK,aAGxB9B,EAAAA,EAAAA,IAAqC,OAAhCJ,MAAM,aAAY,YAAQ,mBAGjCI,EAAAA,EAAAA,IAAiB,MAAbJ,MAAM,QAAM,WAEhBI,EAAAA,EAAAA,IAQM,MARNgC,EAQM,EAPJhC,EAAAA,EAAAA,IAMS,UALPoB,KAAK,SACLxB,MAAM,yBACLmC,SAAUzB,EAAA2B,S,QAER3B,EAAA2B,OAAS,SAAW,QAAd,EAlE/BC,MAAA,kB,8DAuFA,GACEV,KAAM,cACNW,KAAAA,GACE,MAAMC,GAASC,EAAAA,EAAAA,MACT9B,GAAU+B,EAAAA,EAAAA,KAAI,GACdL,GAASK,EAAAA,EAAAA,KAAI,GACbC,GAAcD,EAAAA,EAAAA,IAAI,MAElBf,GAAUe,EAAAA,EAAAA,IAAI,CAClBd,KAAM,GACNM,MAAO,GACPF,MAAO,MAGTY,EAAAA,EAAAA,KAAU,MACRC,EAAAA,EAAAA,IAAmBC,EAAAA,IAAMC,UACnBC,GACFL,EAAYM,MAAQD,QACdE,EAAcF,EAAKG,MAEzBX,EAAOY,KAAK,SACd,GACA,IAGJ,MAAMF,EAAgBH,UACpB,IACE,MAAMM,QAAgBC,EAAAA,EAAAA,KAAOC,EAAAA,EAAAA,IAAIC,EAAAA,GAAI,QAASC,IAC9C,GAAIJ,EAAQK,SAAU,CACpB,MAAMC,EAAWN,EAAQO,OACzBjC,EAAQsB,MAAQ,CACdrB,KAAM+B,EAAS/B,MAAQ,GACvBM,MAAOyB,EAASzB,OAAS,GACzBF,MAAO2B,EAAS3B,OAAS,GAE7B,CACF,CAAE,MAAO6B,GACPC,QAAQC,MAAM,4BAA6BF,GAC3CG,MAAM,iBACR,CAAE,QACArD,EAAQsC,OAAQ,CAClB,GAGI9B,EAAgB4B,UACpB,GAAKpB,EAAQsB,MAAMrB,MAASD,EAAQsB,MAAMjB,MAA1C,CAKAK,EAAOY,OAAQ,EAEf,IACE,MAAMgB,GAAUV,EAAAA,EAAAA,IAAIC,EAAAA,GAAI,QAASb,EAAYM,MAAME,WAE7Ce,EAAAA,EAAAA,IAAUD,EAAS,CACvBrC,KAAMD,EAAQsB,MAAMrB,KACpBI,MAAOL,EAAQsB,MAAMjB,MACrBmC,WAAWC,EAAAA,EAAAA,QAGbJ,MAAM,WACNxB,EAAOY,KAAK,aACd,CAAE,MAAOS,GACPC,QAAQC,MAAM,0BAA2BF,GACzCG,MAAM,iBACR,CAAE,QACA3B,EAAOY,OAAQ,CACjB,CApBA,MAFEe,MAAM,YAsBR,EAGF,MAAO,CACLrD,UACA0B,SACAV,UACAR,gBAEJ,G,UC7JF,MAAMkD,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://badminton-registration/./src/views/ProfileView.vue","webpack://badminton-registration/./src/views/ProfileView.vue?3e49"],"sourcesContent":["<template>\r\n  <div class=\"profile\">\r\n    <div class=\"container py-4\">\r\n      <div class=\"row justify-content-center\">\r\n        <div class=\"col-md-8\">\r\n          <div class=\"card\">\r\n            <div class=\"card-header bg-primary text-white\">\r\n              <h3 class=\"mb-0\">個人資料</h3>\r\n            </div>\r\n            <div class=\"card-body\">\r\n              <div v-if=\"loading\" class=\"text-center py-4\">\r\n                <div class=\"spinner-border text-primary\" role=\"status\">\r\n                  <span class=\"visually-hidden\">載入中...</span>\r\n                </div>\r\n                <p>載入用戶資料...</p>\r\n              </div>\r\n              \r\n              <div v-else>\r\n                <form @submit.prevent=\"updateProfile\">\r\n                  <div class=\"row mb-4\">\r\n                    <div class=\"col-md-6\">\r\n                      <div class=\"mb-3\">\r\n                        <label for=\"name\" class=\"form-label\">姓名</label>\r\n                        <input \r\n                          type=\"text\" \r\n                          class=\"form-control\" \r\n                          id=\"name\" \r\n                          v-model=\"profile.name\" \r\n                          required\r\n                        >\r\n                      </div>\r\n                    </div>\r\n                    <div class=\"col-md-6\">\r\n                      <div class=\"mb-3\">\r\n                        <label for=\"phone\" class=\"form-label\">電話</label>\r\n                        <input \r\n                          type=\"tel\" \r\n                          class=\"form-control\" \r\n                          id=\"phone\" \r\n                          v-model=\"profile.phone\" \r\n                          required\r\n                        >\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div class=\"mb-4\">\r\n                    <label for=\"email\" class=\"form-label\">電子郵件</label>\r\n                    <input \r\n                      type=\"email\" \r\n                      class=\"form-control\" \r\n                      id=\"email\" \r\n                      v-model=\"profile.email\" \r\n                      disabled\r\n                    >\r\n                    <div class=\"form-text\">電子郵件無法修改</div>\r\n                  </div>\r\n                  \r\n                  <hr class=\"my-4\">\r\n                  \r\n                  <div class=\"d-grid\">\r\n                    <button \r\n                      type=\"submit\" \r\n                      class=\"btn btn-primary btn-lg\" \r\n                      :disabled=\"saving\"\r\n                    >\r\n                      {{ saving ? '儲存中...' : '儲存變更' }}\r\n                    </button>\r\n                  </div>\r\n                </form>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n/* eslint-disable no-undef */\r\nimport { ref, onMounted } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport { onAuthStateChanged } from 'firebase/auth';\r\nimport { doc, getDoc, updateDoc, serverTimestamp } from 'firebase/firestore';\r\nimport { auth, db } from '@/firebase';\r\n\r\nexport default {\r\n  name: 'ProfileView',\r\n  setup() {\r\n    const router = useRouter();\r\n    const loading = ref(true);\r\n    const saving = ref(false);\r\n    const currentUser = ref(null);\r\n    \r\n    const profile = ref({\r\n      name: '',\r\n      email: '',\r\n      phone: ''\r\n    });\r\n    \r\n    onMounted(() => {\r\n      onAuthStateChanged(auth, async (user) => {\r\n        if (user) {\r\n          currentUser.value = user;\r\n          await fetchUserData(user.uid);\r\n        } else {\r\n          router.push('/login');\r\n        }\r\n      });\r\n    });\r\n    \r\n    const fetchUserData = async (userId) => {\r\n      try {\r\n        const userDoc = await getDoc(doc(db, 'users', userId));\r\n        if (userDoc.exists()) {\r\n          const userData = userDoc.data();\r\n          profile.value = {\r\n            name: userData.name || '',\r\n            email: userData.email || '',\r\n            phone: userData.phone || ''\r\n          };\r\n        }\r\n      } catch (e) {\r\n        console.error('Error fetching user data:', e);\r\n        alert('無法載入用戶資料，請稍後再試');\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n    \r\n    const updateProfile = async () => {\r\n      if (!profile.value.name || !profile.value.phone) {\r\n        alert('請填寫所有必填欄位');\r\n        return;\r\n      }\r\n      \r\n      saving.value = true;\r\n      \r\n      try {\r\n        const userRef = doc(db, 'users', currentUser.value.uid);\r\n        \r\n        await updateDoc(userRef, {\r\n          name: profile.value.name,\r\n          phone: profile.value.phone,\r\n          updatedAt: serverTimestamp()\r\n        });\r\n        \r\n        alert('個人資料已更新');\r\n        router.push('/dashboard');\r\n      } catch (e) {\r\n        console.error('Error updating profile:', e);\r\n        alert('更新個人資料失敗，請稍後再試');\r\n      } finally {\r\n        saving.value = false;\r\n      }\r\n    };\r\n    \r\n    return {\r\n      loading,\r\n      saving,\r\n      profile,\r\n      updateProfile\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.profile {\r\n  padding-bottom: 2rem;\r\n}\r\n\r\n.card {\r\n  box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);\r\n  border: none;\r\n  border-radius: 0.5rem;\r\n  overflow: hidden;\r\n}\r\n\r\n.card-header {\r\n  padding: 1.25rem;\r\n}\r\n\r\n.btn-lg {\r\n  padding: 0.75rem 1.5rem;\r\n  font-size: 1.125rem;\r\n}\r\n</style>\r\n","import { render } from \"./ProfileView.vue?vue&type=template&id=0a695243&scoped=true\"\nimport script from \"./ProfileView.vue?vue&type=script&lang=js\"\nexport * from \"./ProfileView.vue?vue&type=script&lang=js\"\n\nimport \"./ProfileView.vue?vue&type=style&index=0&id=0a695243&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0a695243\"]])\n\nexport default __exports__"],"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","$setup","loading","_hoisted_7","_cache","role","_hoisted_8","onSubmit","_withModifiers","args","updateProfile","_hoisted_9","_hoisted_10","_hoisted_11","for","type","id","$event","profile","name","required","_hoisted_12","_hoisted_13","phone","_hoisted_14","email","disabled","_hoisted_15","saving","_hoisted_16","setup","router","useRouter","ref","currentUser","onMounted","onAuthStateChanged","auth","async","user","value","fetchUserData","uid","push","userDoc","getDoc","doc","db","userId","exists","userData","data","e","console","error","alert","userRef","updateDoc","updatedAt","serverTimestamp","__exports__","render"],"sourceRoot":""}